# Vector Search API - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üåê –î–æ—Å—Ç—É–ø –∫ API

**Swagger UI (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å):** http://10.10.4.38:8000/docs
**API Endpoint:** http://10.10.4.38:8000
**Health Check:** http://10.10.4.38:8000/health

---

## üìö –î–≤–∞ —ç–Ω–¥–ø–æ–π–Ω—Ç–∞

### 1Ô∏è‚É£ POST /search - –ë—ã—Å—Ç—Ä—ã–π –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ (~500ms)

–ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "query": "—à–∫–æ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
  "top_n": 10,
  "method": "cosine"
}
```

**–ü—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ curl:**
```bash
curl -X POST http://10.10.4.38:8000/search \
  -H "Content-Type: application/json" \
  -d '{"query": "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏—è", "top_n": 5}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "results": [
    {
      "table_name": "edu_schools",
      "score": 0.68
    }
  ],
  "total": 1
}
```

---

### 2Ô∏è‚É£ POST /search_rerank - –£–º–Ω—ã–π –ø–æ–∏—Å–∫ —Å LLM (~10s)

–ü–æ–∏—Å–∫ + —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥ —á–µ—Ä–µ–∑ LLM (Gemma3:27b). –ú–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–∞–º–Ω–æ–≥–æ —Ç–æ—á–Ω–µ–µ!

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "query": "—à–∫–æ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
  "prompt": "–ù—É–∂–Ω—ã —Ç–∞–±–ª–∏—Ü—ã —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —à–∫–æ–ª–∞—Ö, —É—á–µ–Ω–∏–∫–∞—Ö –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É—á—Ä–µ–∂–¥–µ–Ω–∏—è—Ö",
  "top_n": 50,
  "method": "cosine"
}
```

**–ü—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ curl:**
```bash
curl -X POST http://10.10.4.38:8000/search_rerank \
  -H "Content-Type: application/json" \
  -d '{
    "query": "—à–∫–æ–ª—ã",
    "prompt": "–ò—â—É –¥–∞–Ω–Ω—ã–µ –æ —à–∫–æ–ª–∞—Ö –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏",
    "top_n": 20
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "results": [
    {
      "table_name": "edu_schools",
      "score": 10.0,
      "table_description": "This table contains information about schools..."
    },
    {
      "table_name": "edu_performance",
      "score": 8.0,
      "table_description": "Performance metrics for schools..."
    }
  ],
  "total": 2
}
```

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:
```bash
curl -X POST http://10.10.4.38:8000/search_rerank \
  -H "Content-Type: application/json" \
  -d '{
    "query": "–¥–µ—Ç—Å–∫–∏–µ —Å–∞–¥—ã",
    "prompt": "–ò—â—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—à–∫–æ–ª—å–Ω—ã—Ö —É—á—Ä–µ–∂–¥–µ–Ω–∏—è—Ö",
    "top_n": 15
  }'
```

### –ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:
```bash
curl -X POST http://10.10.4.38:8000/search_rerank \
  -H "Content-Type: application/json" \
  -d '{
    "query": "–±–æ–ª—å–Ω–∏—Ü—ã –∏ –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∏",
    "prompt": "–ù—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É—á—Ä–µ–∂–¥–µ–Ω–∏—è—Ö",
    "top_n": 15
  }'
```

### –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç:
```bash
curl -X POST http://10.10.4.38:8000/search_rerank \
  -H "Content-Type: application/json" \
  -d '{
    "query": "–¥–æ—Ä–æ–≥–∏ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç",
    "prompt": "–ò—â—É –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ",
    "top_n": 15
  }'
```

---

## üêç –ü—Ä–∏–º–µ—Ä –Ω–∞ Python

```python
import requests
import json

# –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫
response = requests.post(
    "http://10.10.4.38:8000/search",
    json={
        "query": "—à–∫–æ–ª—ã",
        "top_n": 5,
        "method": "cosine"
    }
)
print(json.dumps(response.json(), indent=2, ensure_ascii=False))

# –£–º–Ω—ã–π –ø–æ–∏—Å–∫ —Å LLM
response = requests.post(
    "http://10.10.4.38:8000/search_rerank",
    json={
        "query": "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏—è",
        "prompt": "–ò—â—É –¥–∞–Ω–Ω—ã–µ –æ –±–æ–ª—å–Ω–∏—Ü–∞—Ö –∏ –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞—Ö",
        "top_n": 20,
        "method": "cosine"
    }
)
print(json.dumps(response.json(), indent=2, ensure_ascii=False))
```

---

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

### –î–ª—è `/search`:
- `query` (str) - **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
- `top_n` (int) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (1-100, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
- `method` (str) - –º–µ—Ç–æ–¥ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è: "cosine", "L2", "dot_product" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "cosine")

### –î–ª—è `/search_rerank`:
- `query` (str) - **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
- `prompt` (str) - **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è LLM
- `top_n` (int) - –∫–æ–ª-–≤–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–∞ (1-100, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
- `method` (str) - –º–µ—Ç–æ–¥ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è: "cosine", "L2", "dot_product" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "cosine")

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Swagger UI** (http://10.10.4.38:8000/docs) - —Ç–∞–º —É–¥–æ–±–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. **–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/search`
3. **–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/search_rerank` —Å —Ö–æ—Ä–æ—à–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤ `prompt`
4. **–í prompt –ø–∏—à–∏—Ç–µ** —á—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –∏—â–µ—Ç–µ, LLM —ç—Ç–æ —É—á—Ç—ë—Ç
5. **–†–µ—Ä–∞–Ω–∫–∏–Ω–≥ –∑–∞–Ω–∏–º–∞–µ—Ç ~10 —Å–µ–∫—É–Ω–¥** - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, LLM –¥—É–º–∞–µ—Ç

---

## üî• –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±:

**–ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:** http://10.10.4.38:8000/docs

–ò –Ω–∞–∂–∏–º–∞–π—Ç–µ "Try it out" –Ω–∞ —ç–Ω–¥–ø–æ–π–Ω—Ç–∞—Ö!

---

–í–æ–ø—Ä–æ—Å—ã? –ü–∏—à–∏—Ç–µ! üòä
